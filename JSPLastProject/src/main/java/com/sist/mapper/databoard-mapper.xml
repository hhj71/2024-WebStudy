<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.sist.mapper.databoard-mapper">
 	<!-- 
 			<sql>	: SQL 문장의 중복 제거 = <include>
 			<select id="" 		resultType="" 					parameterType="" 	resultMap="">	
 						====		==========					================	===========
 						구분자	 결과값(SQL => 담는 변수)	?에 값을 채운다			컬럼명이 다른 경우
 																														=> 컬럼명 / VO의 변수명
 			<resultMap id= ""  type="BoardVO">
 				<result column ="board_no" property="dvo.no"/>
 			</resultMap> => JOIN => vo.getDvo().setName																				
 																														
 			컬럼명 : board_no , board_name ..
 			VO : no name subject
 			SELECT board_no as no, name, subject	....
 			=================================
 					setBoard_no()
 					setNo() . setName(), setSubject()																										
 			<insert id=""	parameterType=""> = <selectKey> : 자동증가번호
 			<update id=""	parameterType="">
 			<delete id=""	parameterType="">
 			= id는 중복이 되면 안된다
 				==================  HTML/CSS = JavaScript : <jsp:include>
 				#{} / ${} => 구분
 				
 				JOIN / SUBQuery
  	 -->
  	 <!--  추가  -->
  	 <insert id="databoardInsert" parameterType="DataBoardVO">
  	 	INSERT INTO project_databoard VALUES(
  	 		(SELECT NVL(MAX(no)+1,1) FROM project_databoard),
  	 		#{name}, #{subject}, #{content}, #{pwd}, SYSDATE, 0, 
  	 		#{filename}, #{filesize}
  	 	)
  	 </insert>
  	 <!--  목록 -->
  	 <select id ="databoardListData" parameterType="hashmap" resultType="DataBoardVO">
  	 	SELECT no, subject, name, TO_CHAR(regdate,'YYYY-MM-DD') as dbday, hit, num
  	 	FROM (SELECT no, subject, name, regdate, hit, rownum as num
  	 	FROM (SELECT /*+ INDEX_DESC(project_databoard  pd_no_pk)*/ no, subject, name, regdate, hit
  	 	FROM project_databoard))
  	 	WHERE num BETWEEN #{start} AND #{end}
  	 </select>
   <select id="databoardRowCount" resultType="int">
    SELECT COUNT(*) FROM project_databoard
   </select>
   <!-- 상세보기 -->
   <update id="databoardhitIncrement" parameterType="int">
     UPDATE project_databoard SET 
     hit=hit+1
     WHERE no=#{no}
   </update>
   <select id="databoardDetailData" resultType="DataBoardVO" parameterType="int">
     SELECT no,name,subject,content,
            TO_CHAR(regdate,'YYYY-MM-DD HH24:MI:SS') as dbday,
            hit,filename,filesize
     FROM project_databoard
     WHERE no=#{no}
   </select>
   <!-- 수정 -->
   <!-- 삭제 -->
   <select id="databoardGetPassword" resultType="string" parameterType="int">
     SELECT pwd FROM project_databoard
     WHERE no=#{no}
   </select>
   <select id="databoardFileInfoData" resultType="DataBoardVO" parameterType="int">
     SELECT filename,filesize 
     FROM project_databoard
     WHERE no=#{no}
   </select>
   <delete id="databoardDelete" parameterType="int">
    DELETE FROM project_databoard
    WHERE no=#{no}
   </delete>
   <!-- *** 동적 쿼리 : 검색 
   			
   				${}	=> 문자열 => 컬럼, 테이블명 지정 => ' ' 사용하지 않는다 
   				#{}   => 문자열 => 일반 데이터 => 원래 ' ' 사용하는 경우
   				  ex) WHERE name = '홍길동'
   
			조건걸고 검색 할 때 다른 것도 같이 검색되지 않게 OR / AND 사용이 필요함    
   						overrides ==> 제거할 때 사용 (앞/뒤)
   						
   -->
   <select id="databoardFindData" resultType="DataBoardVO" parameterType="hashmap">
   		SELECT no, name, subject, TO_CHAR(regdate, 'YYYY-MM-DD') as dbday, hit
   		FROM project_databoard
   		<!--  WHERE ${fs} LIKE '%'||#{ss}||'%' -->
   		WHERE 
   			<trim prefix="(" suffix=")" prefixOverrides = "OR" >
   			
   			
   			</trim>
   </select>
</mapper>